@import "node_modules/bootstrap/scss/_functions";
@import "node_modules/bootstrap/scss/_variables";
@import "node_modules/bootstrap/scss/_variables-dark";
@import "node_modules/bootstrap/scss/_mixins";
@import "node_modules/bootstrap/scss/_close";


/* Limit width for readability on large screen sizes */
@media (min-width: 1200px) {
    .container {
        width: 960px;
    }
}

/* Limit width to 50% on desktop but not mobile */
@media (min-width: 768px) {
    .max-width-md-50 {
        max-width: 50%;
    }
}

/* Remove border around disabled buttons */
.btn:disabled, .btn:active {
    border-color: transparent !important
}

/* Set table column to minimum width with class */
td {
    width: 50%;
}

td.min {
    width: 1%;
    white-space: nowrap;
}

/* Vertically center contents of table row */
tr {
    vertical-align: middle;
}

/* Section backgrounds (existing nodes, schedule keywords) */
.section {
    background-color: #eee;
    border: 1px solid #c8c8c8;
    border-radius: 15px;
    padding: 0.5rem;
    margin: 0.1rem;
    text-align: center;
}

/* Table hover highlight rounded corners */
th span {
    display: block;
    padding: 0.375rem 0.75rem;
    line-height: 1;
}

th:first-child{
    border-top-left-radius: 10px;
    border-bottom-left-radius: 10px;
}

th:last-child{
    border-top-right-radius: 10px;
    border-bottom-right-radius: 10px;
}

td:first-child{
    border-top-left-radius: 10px;
    border-bottom-left-radius: 10px;
}

td:last-child{
    border-top-right-radius: 10px;
    border-bottom-right-radius: 10px;
}
/* --- */

/* Upload complete checkmark animation */
@media (prefers-color-scheme: light) {
    :root {
        --success: #198754;
    }
}

@media (prefers-color-scheme: dark) {
    :root {
        --success: #177a4c;
    }
}

/* Small checkmark animation for macro buttons */
.checkmark__circle_sm {
    stroke-dasharray: 166;
    stroke-dashoffset: 166;
    stroke-width: 6;
    stroke-miterlimit: 10;
    stroke: #fff;
    fill: none;
    animation: stroke 0.6s cubic-bezier(0.65, 0, 0.45, 1) forwards;
}

.checkmark_sm {
    width: 2rem;
    height: 2rem;
    border-radius: 50%;
    display: block;
    stroke-width: 5;
    stroke: #fff;
    stroke-miterlimit: 10;
    box-shadow: inset 0px 0px 0px #fff;
}

.checkmark__check_sm {
    transform-origin: 50% 50%;
    stroke-dasharray: 48;
    stroke-dashoffset: 48;
    animation: stroke 0.3s cubic-bezier(0.65, 0, 0.45, 1) 0.8s forwards;
}

/* Large checkmark animation for config uploads */
.checkmark__circle {
    stroke-dasharray: 166;
    stroke-dashoffset: 166;
    stroke-width: 2;
    stroke-miterlimit: 10;
    stroke: var(--success);
    fill: none;
    animation: stroke 0.6s cubic-bezier(0.65, 0, 0.45, 1) forwards;
}

.checkmark {
    width: 3rem;
    height: 3rem;
    border-radius: 50%;
    display: block;
    stroke-width: 2;
    stroke: #fff;
    stroke-miterlimit: 10;
    box-shadow: inset 0px 0px 0px var(--success);
    animation: fill .4s ease-in-out .4s forwards, scale .3s ease-in-out .9s both;
}

.checkmark__check {
    transform-origin: 50% 50%;
    stroke-dasharray: 48;
    stroke-dashoffset: 48;
    animation: stroke 0.3s cubic-bezier(0.65, 0, 0.45, 1) 0.8s forwards;
}

@keyframes stroke {
    100% {
        stroke-dashoffset: 0;
    }
}

@keyframes scale {
    0%, 100% {
        transform: none;
    }
    50% {
        transform: scale3d(1.1, 1.1, 1);
    }
}

@keyframes fill {
    100% {
        box-shadow: inset 0px 0px 0px 30px var(--success);
    }
}

.text-dim {
    color: #000000;
    opacity: 50%;
}

/* Delete instance card animation */
:root {
    --animation-height: 25rem;
}

@keyframes slide-up {
    0% {
        bottom: 0rem;
    }
    100% {
        bottom: var(--animation-height);
    }
}

.slide-up {
    animation-name: slide-up;
    animation-duration: 0.8s;
    animation-timing-function: ease;
    animation-fill-mode: forwards;
}

@keyframes fade-out {
    0% {
        opacity: 100%;
    }
    100% {
        opacity: 0%;
    }
}

/* Delete card in config editor */
.fade-out-card {
    animation-name: fade-out;
    animation-duration: 0.4s;
    animation-timing-function: ease;
    animation-fill-mode: forwards;
}

/* Popup div for setting timestamp and rule on page 3 */
.schedule-rule-param-popup {
    position: absolute;
    border: 3px solid #1B1E1F;
    border-radius: 8px;
    padding: 20px;
    background-color: #212529;
    z-index: 99;
    margin-left: 20px;
    margin-right: 20px;
    min-width: fit-content;
}

/* Remove dropdown down arrow */
.dropdown-toggle::after {
    display: none !important;
}

/* Mobile: Full width popup div instead of aligning to parent element */
@media screen and (max-width: 768px) {
    .schedule-rule-param-popup {
        min-width: calc(100% - 40px);
        margin-left: 20px;
        left: 0;
    }
}

/* Fade animations (api frontend) */
.fade-out {
    opacity: 100%;
    animation: fade-out 0.2s forwards;
}

.fade-in {
    opacity: 0%;
    animation: fade-in 0.2s forwards;
}

@keyframes fade-out {
    0% {
        opacity: 100%
    }
    100% {
        opacity: 0%
    }
}

@keyframes fade-in {
    0% {
        opacity: 0%
    }
    100% {
        opacity: 100%
    }
}

/* Macro buttons */
.btn-macro {
    height: 3rem;
    width: 3rem;
    padding: 0px !important;
}

/* Macro running spinner */
.loading-animation {
    width: 2rem;
    height: 2rem;
}

.loading-animation div {
    box-sizing: border-box;
    display: block;
    position: absolute;
    width: 2rem;
    height: 2rem;
    margin: auto;
    border: 3px solid #fff;
    border-radius: 50%;
    animation: loading-animation 1.2s cubic-bezier(0.5, 0, 0.5, 1) infinite;
    border-color: #fff transparent transparent transparent;
}

.loading-animation div:nth-child(1) {
    animation-delay: -0.45s;
}

.loading-animation div:nth-child(2) {
    animation-delay: -0.3s;
}

.loading-animation div:nth-child(3) {
    animation-delay: -0.15s;
}

@keyframes loading-animation {
    0% {
        transform: rotate(0deg);
    }
    100% {
        transform: rotate(360deg);
    }
}

/* Prevent horizontal margins on modal */
/* Margin keeps centerd on mobile */
/* Used in record macro modal */
.modal-fit-contents div:nth-child(1) {
    max-width: fit-content !important;
    margin: auto !important;
}

@media (prefers-color-scheme: dark) {
    :root {
        /* redefine theme colors for dark theme */
        $primary: #0550b8; /*button color*/
        $secondary: #4b5157;
        $success: #177a4c;

        $theme-colors: (
            "primary": $primary,
            "secondary": $secondary,
            "success": $success,
            "danger": $danger,
            "info": $indigo,
            "dark": $dark,
            "light": $light,
        );

        /* redefine theme color variables */
        @each $color, $value in $theme-colors {
            --#{$variable-prefix}#{$color}: #{$value};
        }

        /* redefine theme color rgb vars (used for bg- colors) */
        $theme-colors-rgb: map-loop($theme-colors, to-rgb, "$value");
        @each $color, $value in $theme-colors-rgb {
            --#{$variable-prefix}#{$color}-rgb: #{$value};
        }

        $body-color: #eee;
        $body-bg: #1b1e1f;
        $card-bg: #212529;
        $table-color: #eee;

        /* Tables */
        $table-bg: #212529 !important;
        $table-hover-bg: #35393f !important;

        /* Modals */
        $modal-content-bg: #31363b;
        $modal-header-border-color: #31363b;
        $modal-footer-border-color: #31363b;

        /* Use light modal close button in dark mode */
        .btn-close {
            @include btn-close-white();
        }

        /* Input fields */
        $input-bg: #1B1E1F;
        $input-color: #ffffff;
        $input-placeholder-color: #696b6e;
        $input-border-color: #232627;

        $input-focus-bg: #1B1E1F;
        $input-focus-border-color: #232627;
        $input-focus-color: #ffffff;
        $input-disabled-bg: #272c31;

        /* Stop floating label changing color when focused */
        .form-floating .form-control ~ label {
            color: rgba(238, 238, 238, 0.65) !important;
        }

        /* Checkboxes */
        $form-check-input-bg: #1B1E1F;
        $form-check-input-border: #1B1E1F;
        $form-check-input-checked-bg-color: $primary;

        /* Select inputs */
        $form-select-bg: #1B1E1F !important;
        $form-select-color: #ffffff !important;
        $form-select-border-color: #232627 !important;
        $form-select-focus-border-color: #232627 !important;
        $form-select-disabled-bg: #272c31 !important;
        $form-select-disabled-color: #ffffff !important;
        $form-select-disabled-border-color: #232627 !important;

        /* Different color for select placeholder text (selected text set to fff above) */
        select:invalid {
            color: #696b6e;
        }

        /* Use lighter color for inputs outside cards (background contrast) */
        /* Overrides styles above with more-specific selector */
        #metadata input {
            background-color: #31363b;
        }

        /* Contrasting background for inputs inside modal */
        .modal-input, .modal-input:focus {
            background-color: #1b1e1f !important;
        }

        /* Contrasting background for dropdowns inside modal */
        .modal-dropdown {
            background-color: #1b1e1f !important;
        }

        /* Fix form validation messages in dark mode */
        .is-invalid~.invalid-feedback, .is-invalid~.invalid-tooltip, .was-validated :invalid~.invalid-feedback, .was-validated :invalid~.invalid-tooltip {
            display: block;
        }

        /* Top-right dropdown menu button color */
        #settings-button {
            color: $light;
            border-color: $dark;
            background-color: $dark;

            &:hover {
                border-color: darken($dark, 5%);
                background-color: darken($dark, 5%);
            }
            &.show, &:active {
                border-color: darken($dark, 10%);
                background-color: darken($dark, 10%);
            }
        }

        /* Increase contrast for disabled items */
        $dropdown-link-disabled-color: #737578 !important;

        $dropdown-bg: #343A40;
        $dropdown-link-hover-bg: #52575C;

        /* Force bold white text on buttons (readability) */
        .btn {
            color: #fff !important;
            font-weight: bold !important;
        }

        /* Fix slight annoying color difference between radio button and submit button */
        .btn-check:active + .btn-outline-primary, .btn-check:checked + .btn-outline-primary, .btn-outline-primary.active, .btn-outline-primary.dropdown-toggle.show, .btn-outline-primary:active {
            background-color: $primary;
            border-color: $primary;
        }

        /* ApiTarget rule modal On/Off toggle */
        .btn-check + .btn-dark {
            background-color: #282d32;
            border-color: #282d32;
        }
        .btn-check:active + .btn-dark, .btn-check:checked + .btn-dark {
            background-color: #1B1E1F;
            border-color: #1B1E1F;
        }

        --#{$variable-prefix}body-color: #{$body-color};
        --#{$variable-prefix}body-bg: #{$body-bg};

        /* Prevent color change on focus (not enough contrast with body bg) */
        .btn-dark:hover, .btn-dark:focus, .btn-dark:active {
            background-color: #212529 !important;
            border-color: #212529 !important;
        }

        /* Toasts */
        $toast-background-color: #394047cc;

        /* Section background color override */
        .section {
            border: 0px;
            background-color: #212529;
        }

        .text-dim {
            color: #FFFFFF;
        }

        /* List group (location suggestions) */
        $list-group-bg: #212529;
        $list-group-border-color: rgba(0, 0, 0, 0.125);
        $list-group-hover-bg: #1B1E1F;
        $list-group-action-hover-bg: #1B1E1F;
        $list-group-active-bg: #1B1E1F;
        $list-group-action-active-bg: #1B1E1F;
        $list-group-color: #dddddd;
        $list-group-hover-color: #ffffff;
        $list-group-action-hover-color: #ffffff;
        $list-group-action-active-color: #ffffff;

        @import "node_modules/bootstrap/scss/_card";
        @import "node_modules/bootstrap/scss/_modal";
        @import "node_modules/bootstrap/scss/_forms";
        @import "node_modules/bootstrap/scss/_buttons";
        @import "node_modules/bootstrap/scss/_tables";
        @import "node_modules/bootstrap/scss/_dropdown";
        @import "node_modules/bootstrap/scss/_toasts";
        @import "node_modules/bootstrap/scss/_list-group";
    }
}
