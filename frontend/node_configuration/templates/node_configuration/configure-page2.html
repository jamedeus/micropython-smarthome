{% if context %}

        <h3>Select targets for each sensor</h3>

        {% for sensor, type in context.sensors.items %}

            {% if not type == "clear" %}

                <div class="card mb-4">
                    <div class="card-body">
                        <label for="{{sensor}}-targets" class="card-title sensor-targets-label"><b>{{ sensor }} ({{ type }}) targets:</b></label>
                        <div id="{{sensor}}-targets" class="form-check sensor-targets">

                            {% for device, dtype in context.devices.items %}

                                {% if not dtype == "ir-blaster" and not dtype == "clear" %}
                                    <input type="checkbox" class="form-check-input" id="target-{{sensor}}-{{device}}" name="target-{{sensor}}-{{device}}" value="target-{{sensor}}-{{device}}">
                                    <label for="target-{{sensor}}-{{device}}" class="form-check-label">{{ device }} ({{ dtype }})</label><br>
                                {% endif %}

                            {% endfor %}
                        </div>
                    </div>
                </div>

            {% endif %}

        {% endfor %}

        <div class="d-flex justify-content-between mx-3 mt-auto">
            <button id="page2-back-button" type="button" class="btn btn-primary mb-3">Back</button>
            <button type="button" class="btn btn-primary mb-3" style="visibility: hidden;">Submit</button>
            <button id="page2-button" type="button" class="btn btn-primary mb-3">Next</button>
        </div>

    <script>

        document.getElementById('page2-button').addEventListener("click", async function(e) {
            e.preventDefault();

            var next_page = await readForm("configure_page3");
            next_page = await next_page.text()

            $('#page3').html(next_page);

            document.getElementById("page3").classList.add("d-flex");
            document.getElementById("page2").classList.remove("d-flex");
            document.getElementById("page2").style.display = "none";

        });

        document.getElementById('page2-back-button').addEventListener("click", async function(e) {
            e.preventDefault();

            document.getElementById("page1").classList.add("d-flex");
            document.getElementById("page2").classList.remove("d-flex");
            document.getElementById("page2").style.display = "none";
        });

    </script>

{% else %}

{% endif %}
